# 自動打卡系統 (Auto Punch Card System)

一個基於 Python 和 Tkinter 的智能自動打卡系統，支持大小周休息制度、多種打卡模式和 Windows 開機自啟動功能。

## 🌟 主要功能

### 📅 智能大小周管理
- **大周末模式**：星期一、星期二休息
- **小周末模式**：僅星期一休息
- **自動週期切換**：大小周自動交替進行
- **靈活起始點設定**：可自定義大周末週期起始日期

### ⏰ 多樣化打卡模式
- **精確時間打卡**：在指定時間精確執行（±15秒容差）
- **隨機時間打卡**：在指定時間區間內隨機執行
- **上下班分別設定**：上班和下班可使用不同的打卡模式
- **智能防重複**：每日自動重置執行狀態，避免重複打卡

### 🔄 自動化排程
- **後台監控**：每10秒檢查一次打卡時間
- **休息日跳過**：自動識別休息日，不執行打卡
- **開機自啟動**：支持 Windows 工作排程器自動啟動
- **網路依賴檢查**：確保網路連線可用時才執行

### 📊 完整日誌系統
- **輪轉日誌**：自動管理日誌檔案大小（5MB 限制）
- **多級記錄**：詳細記錄系統運行狀態和錯誤信息
- **實時顯示**：GUI 界面即時顯示打卡記錄和系統狀態

### 🎯 用戶友好界面
- **直觀設定**：圖形化界面輕鬆配置所有參數
- **即時反饋**：實時顯示當前週末狀態和系統運行情況
- **手動操作**：支持手動執行上下班打卡
- **狀態監控**：清晰顯示自動打卡啟用狀態

## 📁 項目結構

```
PunchCardProject/
├── punch_card_app.py          # 主程式 - GUI 應用程式
├── setup_task_scheduler.py    # Windows 工作排程器設定工具
├── simple_test.py            # 大小周邏輯測試工具
├── punch_config.json         # 配置檔案（自動生成）
├── weekend_test_result.txt   # 測試結果檔案
├── .gitignore               # Git 忽略檔案設定
├── logs/                    # 日誌檔案目錄（自動建立）
│   └── punch_card.log       # 系統運行日誌
└── README.md               # 項目說明文檔
```

## 🚀 快速開始

### 環境需求
- Python 3.7+
- Windows 作業系統
- 網路連線
- 管理員權限（僅設定自啟動時需要）

### 安裝步驟

1. **克隆項目**
   ```bash
   git clone <repository-url>
   cd PunchCardProject
   ```

2. **安裝依賴**
   ```bash
   pip install requests
   ```
   > 注意：tkinter 是 Python 標準庫，無需額外安裝

3. **運行程式**
   ```bash
   python punch_card_app.py
   ```

### 基本配置

1. **設定 Webhook URL**
   - 在主界面輸入您的打卡系統 Webhook URL

2. **配置打卡時間**
   - 選擇精確時間或隨機區間模式
   - 設定上下班時間

3. **設定大小周**
   - 點擊「設為大週末週期起點」設定起始日期
   - 系統將自動計算大小周交替

4. **儲存設定**
   - 點擊「儲存設定」保存所有配置

## ⚙️ 詳細配置說明

### 打卡模式配置

#### 精確時間模式
- 在指定時間的 ±15 秒內執行打卡
- 適合需要準時打卡的場景

#### 隨機區間模式
- 在指定時間區間內隨機選擇執行時間
- 模擬人工打卡的隨機性
- 每日重新生成隨機時間

### 大小周設定

#### 週期規則
- **大周末**：星期一、星期二休息（不執行打卡）
- **小周末**：僅星期一休息（不執行打卡）
- **交替週期**：每週自動切換大小周模式

#### 設定方法
1. 在大周末的第一天點擊「設為大週末週期起點」
2. 系統自動記錄起始日期和模式
3. 後續週期自動計算和切換

### 配置檔案格式

`punch_config.json` 檔案包含以下設定：

```json
{
  "webhook_url": "您的打卡系統URL",
  "punch_in_time": "09:00",
  "punch_out_time": "18:30",
  "punch_in_start": "09:00",
  "punch_in_end": "09:10",
  "punch_out_start": "18:30",
  "punch_out_end": "18:35",
  "punch_in_mode": "exact",
  "punch_out_mode": "random",
  "weekend_mode": "big",
  "weekend_start_date": "2025-06-10"
}
```

## 🔧 進階功能

### Windows 自啟動設定

使用 `setup_task_scheduler.py` 設定開機自啟動：

```bash
python setup_task_scheduler.py
```

功能選項：
1. **建立自動啟動任務** - 設定開機自動啟動
2. **刪除自動啟動任務** - 移除自啟動設定
3. **檢查任務狀態** - 查看當前任務狀態
4. **測試任務執行** - 手動測試任務運行

### 大小周邏輯測試

使用 `simple_test.py` 測試大小周邏輯：

```bash
python simple_test.py
```

測試選項：
1. **預設日期測試** - 測試預定義的關鍵日期
2. **日期範圍測試** - 測試指定日期範圍內的所有日期

測試結果將保存在 `weekend_test_result.txt` 檔案中。

## 📋 使用說明

### 日常使用

1. **啟動程式**
   - 雙擊 `punch_card_app.py` 或從命令列運行
   - 程式將自動載入配置並開始監控

2. **監控狀態**
   - 查看主界面的「系統狀態」區域
   - 觀察「打卡記錄」了解執行歷史

3. **手動打卡**
   - 使用「手動上班打卡」和「手動下班打卡」按鈕
   - 適用於特殊情況或測試用途

4. **啟用/停用自動打卡**
   - 使用「啟用自動打卡」複選框控制
   - 停用後僅可手動打卡

### 故障排除

#### 常見問題

1. **打卡失敗**
   - 檢查網路連線
   - 確認 Webhook URL 正確
   - 查看日誌檔案了解詳細錯誤

2. **時間不準確**
   - 確認系統時間正確
   - 檢查時間格式（HH:MM）

3. **大小周錯誤**
   - 重新設定大週末起始點
   - 使用測試工具驗證邏輯

#### 日誌檔案位置
- 主日誌：`logs/punch_card.log`
- 日誌會自動輪轉，保留最近 5 個檔案

## 🔒 安全注意事項

1. **配置檔案安全**
   - `punch_config.json` 可能包含敏感的 Webhook URL
   - 已加入 `.gitignore`，避免意外提交

2. **網路安全**
   - 確保 Webhook URL 使用 HTTPS
   - 定期檢查和更新 URL

3. **系統權限**
   - 設定自啟動需要管理員權限
   - 日常使用無需特殊權限

## 🤝 貢獻指南

歡迎提交 Issue 和 Pull Request！

### 開發環境設定

1. Fork 本項目
2. 建立功能分支
3. 進行開發和測試
4. 提交 Pull Request

### 程式碼規範

- 使用中文註解
- 遵循 PEP 8 編碼規範
- 添加適當的錯誤處理
- 更新相關文檔

## 📄 授權條款

本項目採用 MIT 授權條款，詳見 LICENSE 檔案。

## 📞 支援與反饋

如有問題或建議，請：
1. 提交 GitHub Issue
2. 查看日誌檔案進行自我診斷
3. 使用測試工具驗證功能

---

**注意**：本系統僅供學習和個人使用，請遵守您所在組織的相關規定和法律法規。