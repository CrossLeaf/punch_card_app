2025-06-04 22:23:07,340 - INFO - 設定檔載入成功: punch_config.json
2025-06-04 22:23:07,352 - INFO - 排程器啟動
2025-06-04 22:23:07,352 - INFO - 應用程式啟動成功
2025-06-04 22:23:20,390 - INFO - 開始測試 Webhook: https://prod-48.southeastasia.logic.azure.com:443/workflows/05d16d6c5b924d278e36280d1e15943f/triggers/manual/paths/invoke?api-version=2016-06-01
2025-06-04 22:23:20,390 - DEBUG - 準備發送 Webhook 請求:
2025-06-04 22:23:20,390 - DEBUG -   URL: https://prod-48.southeastasia.logic.azure.com:443/workflows/05d16d6c5b924d278e36280d1e15943f/triggers/manual/paths/invoke?api-version=2016-06-01
2025-06-04 22:23:20,391 - DEBUG -   資料: {
  "type": "測試打卡",
  "timestamp": "2025-06-04T22:23:20.390936",
  "message": "自動打卡系統 - 測試打卡"
}
2025-06-04 22:23:20,671 - DEBUG - 收到回應:
2025-06-04 22:23:20,671 - DEBUG -   狀態碼: 401
2025-06-04 22:23:20,671 - DEBUG -   回應標頭: {'Content-Length': '155', 'Content-Type': 'application/json; charset=utf-8', 'Date': 'Wed, 04 Jun 2025 14:23:20 GMT', 'Cache-Control': 'no-cache', 'Expires': '-1', 'Pragma': 'no-cache', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains', 'x-ms-request-id': 'southeastasia:8d96b532-01d8-4fae-b832-2db3f1fc5653'}
2025-06-04 22:23:20,671 - DEBUG -   回應內容: {"error":{"code":"DirectApiAuthorizationRequired","message":"The OAuth authorization scheme is required. Please add authentication scheme and try again."}}
2025-06-04 22:23:20,671 - WARNING - Webhook 請求失敗 - 測試打卡, 狀態碼: 401, 回應: {"error":{"code":"DirectApiAuthorizationRequired","message":"The OAuth authorization scheme is required. Please add authentication scheme and try again."}}
2025-06-04 22:23:20,671 - ERROR - Webhook 測試失敗 - 無回應
2025-06-04 22:24:22,862 - INFO - 設定變更: Webhook URL: https://prod-48.southeastasia.logic.azure.com:443/workflows/05d16d6c5b924d278e36280d1e15943f/triggers/manual/paths/invoke?api-version=2016-06-01 -> https://prod-48.southeastasia.logic.azure.com:443/workflows/05d16d6c5b924d278e36280d1e15943f/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=k2MWtkl4AUXxk5Wnl4DuixYneDV7mHhpH_Ylk5wSh1Y
2025-06-04 22:24:22,862 - INFO - 設定變更: 上班時間: 09:00 -> 09:00
2025-06-04 22:24:22,862 - INFO - 設定變更: 下班時間: 18:00 -> 18:00
2025-06-04 22:24:22,864 - INFO - 設定檔儲存成功
2025-06-04 22:24:25,501 - INFO - 開始測試 Webhook: https://prod-48.southeastasia.logic.azure.com:443/workflows/05d16d6c5b924d278e36280d1e15943f/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=k2MWtkl4AUXxk5Wnl4DuixYneDV7mHhpH_Ylk5wSh1Y
2025-06-04 22:24:25,501 - DEBUG - 準備發送 Webhook 請求:
2025-06-04 22:24:25,501 - DEBUG -   URL: https://prod-48.southeastasia.logic.azure.com:443/workflows/05d16d6c5b924d278e36280d1e15943f/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=k2MWtkl4AUXxk5Wnl4DuixYneDV7mHhpH_Ylk5wSh1Y
2025-06-04 22:24:25,501 - DEBUG -   資料: {
  "type": "測試打卡",
  "timestamp": "2025-06-04T22:24:25.501639",
  "message": "自動打卡系統 - 測試打卡"
}
2025-06-04 22:24:25,839 - DEBUG - 收到回應:
2025-06-04 22:24:25,839 - DEBUG -   狀態碼: 202
2025-06-04 22:24:25,840 - DEBUG -   回應標頭: {'Content-Length': '0', 'Date': 'Wed, 04 Jun 2025 14:24:25 GMT', 'Cache-Control': 'no-cache', 'Expires': '-1', 'Pragma': 'no-cache', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains', 'x-ms-workflow-run-id': '08584525598197349426103547572CU24', 'x-ms-correlation-id': '96af55c6-57f2-4c4f-9833-2cd8c66ef7f7', 'x-ms-client-tracking-id': '08584525598197349426103547572CU24', 'x-ms-trigger-history-name': '08584525598197349426103547572CU24', 'x-ms-execution-location': 'southeastasia', 'x-ms-workflow-system-id': '/locations/southeastasia/scaleunits/prod-48/workflows/05d16d6c5b924d278e36280d1e15943f', 'x-ms-workflow-id': '05d16d6c5b924d278e36280d1e15943f', 'x-ms-workflow-version': '08584525598384124482', 'x-ms-workflow-name': 'c5528a89-c8bc-4976-8611-5f037d3d7056', 'x-ms-tracking-id': '96af55c6-57f2-4c4f-9833-2cd8c66ef7f7', 'x-ms-ratelimit-burst-remaining-workflow-writes': '224', 'x-ms-ratelimit-remaining-workflow-download-contentsize': '161060864', 'x-ms-ratelimit-remaining-workflow-upload-contentsize': '161060707', 'x-ms-ratelimit-time-remaining-directapirequests': '14999944', 'x-ms-request-id': 'southeastasia:96af55c6-57f2-4c4f-9833-2cd8c66ef7f7'}
2025-06-04 22:24:25,840 - DEBUG -   回應內容: 
2025-06-04 22:24:25,840 - WARNING - Webhook 請求失敗 - 測試打卡, 狀態碼: 202, 回應: 
2025-06-04 22:24:25,840 - INFO - Webhook 測試成功 - 狀態碼: 202
2025-06-04 22:26:55,143 - INFO - 設定變更: Webhook URL: https://prod-48.southeastasia.logic.azure.com:443/workflows/05d16d6c5b924d278e36280d1e15943f/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=k2MWtkl4AUXxk5Wnl4DuixYneDV7mHhpH_Ylk5wSh1Y -> https://prod-48.southeastasia.logic.azure.com:443/workflows/05d16d6c5b924d278e36280d1e15943f/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=k2MWtkl4AUXxk5Wnl4DuixYneDV7mHhpH_Ylk5wSh1Y
2025-06-04 22:26:55,143 - INFO - 設定變更: 上班時間: 09:00 -> 09:00
2025-06-04 22:26:55,143 - INFO - 設定變更: 下班時間: 18:00 -> 22:28
2025-06-04 22:26:55,144 - INFO - 設定檔儲存成功
2025-06-04 22:28:07,353 - INFO - 觸發下班打卡時間: 22:28
2025-06-04 22:28:07,353 - INFO - 開始自動打卡: 下班打卡
2025-06-04 22:28:07,679 - WARNING - Webhook 請求失敗 - 下班打卡, 狀態碼: 202, 回應: 
2025-06-04 22:28:07,679 - ERROR - 自動打卡失敗: 下班打卡, 狀態碼: 202
2025-06-04 22:33:11,681 - INFO - 設定變更: Webhook URL: https://prod-48.southeastasia.logic.azure.com:443/workflows/05d16d6c5b924d278e36280d1e15943f/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=k2MWtkl4AUXxk5Wnl4DuixYneDV7mHhpH_Ylk5wSh1Y -> https://prod-48.southeastasia.logic.azure.com:443/workflows/05d16d6c5b924d278e36280d1e15943f/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=k2MWtkl4AUXxk5Wnl4DuixYneDV7mHhpH_Ylk5wSh1Y
2025-06-04 22:33:11,681 - INFO - 設定變更: 上班時間: 09:00 -> 09:00
2025-06-04 22:33:11,681 - INFO - 設定變更: 下班時間: 22:28 -> 22:34
2025-06-04 22:33:11,682 - INFO - 設定檔儲存成功
2025-06-04 22:34:07,681 - INFO - 觸發下班打卡時間: 22:34
2025-06-04 22:34:07,682 - INFO - 開始自動打卡: 下班打卡
2025-06-04 22:34:08,006 - WARNING - Webhook 請求失敗 - 下班打卡, 狀態碼: 202, 回應: 
2025-06-04 22:34:08,006 - ERROR - 自動打卡失敗: 下班打卡, 狀態碼: 202
2025-06-04 22:37:22,385 - INFO - 設定檔載入成功: punch_config.json
2025-06-04 22:37:22,428 - INFO - 排程器啟動
2025-06-04 22:37:22,428 - INFO - 應用程式啟動成功
2025-06-04 22:37:51,539 - INFO - 設定檔儲存成功
2025-06-04 22:37:51,539 - INFO - 今日上班隨機打卡時間: 09:16:33
2025-06-04 22:37:51,539 - INFO - 設定儲存成功
2025-06-04 22:37:52,428 - INFO - 觸發上班隨機打卡時間: 22:37:52
2025-06-04 22:37:52,428 - INFO - 開始自動打卡: 上班打卡
2025-06-04 22:37:52,746 - WARNING - Webhook 請求失敗 - 上班打卡, 狀態碼: 202, 回應: 
2025-06-04 22:37:52,746 - ERROR - 自動打卡失敗: 上班打卡, 狀態碼: 202
2025-06-04 22:38:01,767 - INFO - 今日上班隨機打卡時間: 09:05:26
2025-06-04 22:38:05,172 - INFO - 今日上班隨機打卡時間: 09:18:34
2025-06-04 22:38:22,747 - INFO - 觸發上班隨機打卡時間: 22:38:22
2025-06-04 22:38:22,747 - INFO - 開始自動打卡: 上班打卡
2025-06-04 22:38:23,102 - WARNING - Webhook 請求失敗 - 上班打卡, 狀態碼: 202, 回應: 
2025-06-04 22:38:23,102 - ERROR - 自動打卡失敗: 上班打卡, 狀態碼: 202
2025-06-04 22:38:23,102 - INFO - 觸發下班打卡時間: 22:38
2025-06-04 22:38:23,102 - INFO - 開始自動打卡: 下班打卡
2025-06-04 22:38:23,412 - WARNING - Webhook 請求失敗 - 下班打卡, 狀態碼: 202, 回應: 
2025-06-04 22:38:23,412 - ERROR - 自動打卡失敗: 下班打卡, 狀態碼: 202
2025-06-04 22:41:51,151 - INFO - 設定檔儲存成功
2025-06-04 22:41:51,151 - INFO - 今日上班隨機打卡時間: 09:15:24
2025-06-04 22:41:51,152 - INFO - 今日下班隨機打卡時間: 22:44:24
2025-06-04 22:41:51,152 - INFO - 設定儲存成功
2025-06-04 22:41:53,414 - INFO - 觸發上班隨機打卡時間: 22:41:53
2025-06-04 22:41:53,414 - INFO - 開始自動打卡: 上班打卡
2025-06-04 22:41:53,770 - WARNING - Webhook 請求失敗 - 上班打卡, 狀態碼: 202, 回應: 
2025-06-04 22:41:53,770 - ERROR - 自動打卡失敗: 上班打卡, 狀態碼: 202
2025-06-04 22:44:53,771 - INFO - 觸發下班隨機打卡時間: 22:44:53
2025-06-04 22:44:53,772 - INFO - 開始自動打卡: 下班打卡
2025-06-04 22:44:54,120 - WARNING - Webhook 請求失敗 - 下班打卡, 狀態碼: 202, 回應: 
2025-06-04 22:44:54,120 - ERROR - 自動打卡失敗: 下班打卡, 狀態碼: 202
2025-06-04 22:48:35,583 - INFO - 設定檔儲存成功
2025-06-04 22:48:35,583 - INFO - 今日上班隨機打卡時間: 09:18:56
2025-06-04 22:48:35,583 - INFO - 今日下班隨機打卡時間: 22:51:56
2025-06-04 22:48:35,583 - INFO - 設定儲存成功
2025-06-04 22:48:54,122 - INFO - 觸發上班隨機打卡時間: 22:48:54
2025-06-04 22:48:54,122 - INFO - 開始自動打卡: 上班打卡
2025-06-04 22:48:54,463 - WARNING - Webhook 請求失敗 - 上班打卡, 狀態碼: 202, 回應: 
2025-06-04 22:48:54,463 - ERROR - 自動打卡失敗: 上班打卡, 狀態碼: 202
2025-06-04 22:52:24,466 - INFO - 觸發下班隨機打卡時間: 22:52:24
2025-06-04 22:52:24,466 - INFO - 開始自動打卡: 下班打卡
2025-06-04 22:52:24,826 - WARNING - Webhook 請求失敗 - 下班打卡, 狀態碼: 202, 回應: 
2025-06-04 22:52:24,826 - ERROR - 自動打卡失敗: 下班打卡, 狀態碼: 202
2025-06-04 22:52:36,236 - INFO - 設定檔載入成功: punch_config.json
2025-06-04 22:52:36,557 - INFO - 排程器啟動
2025-06-04 22:52:36,557 - INFO - 應用程式啟動成功
2025-06-04 22:52:36,559 - INFO - 今日上班隨機打卡時間: 09:12:09
2025-06-04 22:52:36,559 - INFO - 今日下班隨機打卡時間: 22:50:44
2025-06-04 22:52:36,559 - INFO - 觸發上班隨機打卡時間: 22:52:36
2025-06-04 22:52:36,559 - INFO - 開始自動打卡: 上班打卡
2025-06-04 22:52:37,590 - INFO - Webhook 請求成功 - 上班打卡, 狀態碼: 202
2025-06-04 22:52:37,590 - INFO - 自動打卡成功: 上班打卡, 狀態碼: 202
2025-06-04 22:52:37,590 - INFO - 觸發下班隨機打卡時間: 22:52:36
2025-06-04 22:52:37,590 - INFO - 開始自動打卡: 下班打卡
2025-06-04 22:52:37,901 - INFO - Webhook 請求成功 - 下班打卡, 狀態碼: 202
2025-06-04 22:52:37,901 - INFO - 自動打卡成功: 下班打卡, 狀態碼: 202
2025-06-04 22:52:54,902 - INFO - 設定檔儲存成功
2025-06-04 22:52:54,902 - INFO - 今日上班隨機打卡時間: 09:03:32
2025-06-04 22:52:54,902 - INFO - 設定儲存成功
2025-06-04 22:53:07,902 - INFO - 觸發上班隨機打卡時間: 22:53:07
2025-06-04 22:53:07,902 - INFO - 開始自動打卡: 上班打卡
2025-06-04 22:53:08,220 - INFO - Webhook 請求成功 - 上班打卡, 狀態碼: 202
2025-06-04 22:53:08,220 - INFO - 自動打卡成功: 上班打卡, 狀態碼: 202
2025-06-04 22:53:08,221 - INFO - 觸發下班打卡時間: 22:53
2025-06-04 22:53:08,221 - INFO - 開始自動打卡: 下班打卡
2025-06-04 22:53:08,530 - INFO - Webhook 請求成功 - 下班打卡, 狀態碼: 202
2025-06-04 22:53:08,530 - INFO - 自動打卡成功: 下班打卡, 狀態碼: 202
2025-06-04 22:53:41,630 - INFO - 設定檔儲存成功
2025-06-04 22:53:41,630 - INFO - 今日上班隨機打卡時間: 09:03:55
2025-06-04 22:53:41,630 - INFO - 設定儲存成功
2025-06-04 22:54:08,532 - INFO - 觸發上班隨機打卡時間: 22:54:08
2025-06-04 22:54:08,533 - INFO - 開始自動打卡: 上班打卡
2025-06-04 22:54:08,841 - INFO - Webhook 請求成功 - 上班打卡, 狀態碼: 202
2025-06-04 22:54:08,841 - INFO - 自動打卡成功: 上班打卡, 狀態碼: 202
2025-06-04 22:54:08,842 - INFO - 觸發下班打卡時間: 22:54
2025-06-04 22:54:08,842 - INFO - 開始自動打卡: 下班打卡
2025-06-04 22:54:09,172 - INFO - Webhook 請求成功 - 下班打卡, 狀態碼: 202
2025-06-04 22:54:09,172 - INFO - 自動打卡成功: 下班打卡, 狀態碼: 202
2025-06-04 23:29:50,976 - INFO - 設定檔載入成功: punch_config.json
2025-06-04 23:29:50,992 - INFO - 排程器啟動
2025-06-04 23:29:50,992 - INFO - 應用程式啟動成功
2025-06-04 23:29:50,994 - INFO - 今日上班隨機打卡時間: 09:00:58
2025-06-04 23:29:50,994 - INFO - 觸發上班隨機打卡時間: 23:29:50
2025-06-04 23:29:50,994 - INFO - 開始自動打卡: 上班打卡
2025-06-04 23:29:51,382 - INFO - Webhook 請求成功 - 上班打卡, 狀態碼: 202
2025-06-04 23:29:51,382 - INFO - 自動打卡成功: 上班打卡, 狀態碼: 202
2025-06-04 23:30:11,461 - INFO - 設定檔儲存成功
2025-06-04 23:30:11,461 - INFO - 今日上班隨機打卡時間: 09:13:42
2025-06-04 23:30:11,461 - INFO - 今日下班隨機打卡時間: 23:31:12
2025-06-04 23:30:11,461 - INFO - 設定儲存成功
2025-06-04 23:30:21,382 - INFO - 觸發上班隨機打卡時間: 23:30:21
2025-06-04 23:30:21,382 - INFO - 開始自動打卡: 上班打卡
2025-06-04 23:30:21,672 - INFO - Webhook 請求成功 - 上班打卡, 狀態碼: 202
2025-06-04 23:30:21,672 - INFO - 自動打卡成功: 上班打卡, 狀態碼: 202
2025-06-04 23:31:21,673 - INFO - 觸發下班隨機打卡時間: 23:31:21
2025-06-04 23:31:21,673 - INFO - 開始自動打卡: 下班打卡
2025-06-04 23:31:22,002 - INFO - Webhook 請求成功 - 下班打卡, 狀態碼: 202
2025-06-04 23:31:22,002 - INFO - 自動打卡成功: 下班打卡, 狀態碼: 202
2025-06-05 00:00:22,018 - INFO - 今日上班隨機打卡時間: 09:03:48
2025-06-05 00:00:22,018 - INFO - 今日下班隨機打卡時間: 23:31:03
2025-06-05 00:00:22,018 - INFO - 新的一天開始，重置打卡狀態
2025-06-05 00:00:52,018 - INFO - 新的一天開始，重置打卡狀態
2025-06-05 00:00:58,695 - INFO - 設定檔載入成功: punch_config.json
2025-06-05 00:00:58,716 - INFO - 排程器啟動
2025-06-05 00:00:58,716 - INFO - 應用程式啟動成功
2025-06-05 00:00:58,717 - INFO - 產生上班隨機時間: 09:03:43
2025-06-05 00:00:58,717 - INFO - 產生下班隨機時間: 23:32:32
2025-06-05 00:00:58,717 - INFO - 新的一天開始，重置打卡狀態
